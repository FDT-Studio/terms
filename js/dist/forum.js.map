{"version":3,"sources":["webpack://module.exports/webpack/bootstrap","webpack://module.exports/./forum.js","webpack://module.exports/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://module.exports/./src/common/helpers/sortByAttribute.js","webpack://module.exports/./src/common/models/Policy.js","webpack://module.exports/./src/forum/addAcceptModal.js","webpack://module.exports/./src/forum/addFieldsToRegister.js","webpack://module.exports/./src/forum/addUpdateAlert.js","webpack://module.exports/./src/forum/addUserPoliciesStateControl.js","webpack://module.exports/./src/forum/components/AcceptPoliciesModal.js","webpack://module.exports/./src/forum/components/UpdateAlert.js","webpack://module.exports/./src/forum/components/UserPoliciesStateModal.js","webpack://module.exports/./src/forum/index.js","webpack://module.exports/external \"flarum.core.compat['Component']\"","webpack://module.exports/external \"flarum.core.compat['Model']\"","webpack://module.exports/external \"flarum.core.compat['app']\"","webpack://module.exports/external \"flarum.core.compat['components/Alert']\"","webpack://module.exports/external \"flarum.core.compat['components/Button']\"","webpack://module.exports/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://module.exports/external \"flarum.core.compat['components/IndexPage']\"","webpack://module.exports/external \"flarum.core.compat['components/Modal']\"","webpack://module.exports/external \"flarum.core.compat['components/Page']\"","webpack://module.exports/external \"flarum.core.compat['components/SignUpModal']\"","webpack://module.exports/external \"flarum.core.compat['components/UserPage']\"","webpack://module.exports/external \"flarum.core.compat['extend']\"","webpack://module.exports/external \"flarum.core.compat['models/User']\"","webpack://module.exports/external \"flarum.core.compat['utils/UserControls']\"","webpack://module.exports/external \"flarum.core.compat['utils/computed']\"","webpack://module.exports/external \"flarum.core.compat['utils/mixin']\""],"names":["items","attr","sort","a","b","Policy","apiEndpoint","exists","data","id","attribute","name","url","update_message","terms_updated_at","transformDate","form_key","initialized","extend","prototype","current","user","session","flagrowTermsPoliciesMustAccept","app","modal","show","flagrowTermsPolicies","store","all","forEach","policy","m","prop","children","additionalContent","legalText","forum","push","type","bidi","disabled","loading","translator","trans","href","target","fieldsAdded","child","attrs","className","indexOf","splice","length","console","error","addAlertToContent","original","existing","additional","component","Array","isArray","unshift","override","add","icon","onclick","AcceptPoliciesModal","init","title","content","body","policies","filter","state","flagrowTermsPoliciesState","has_update","close","map","date","moment","format","request","method","errorHandler","onerror","bind","then","updated","pushPayload","redraw","AlertWithContainer","view","vdom","temporarilyHidden","UpdateAlert","shouldShowAlert","flagrowTermsPoliciesHasUpdate","controls","dismissible","ondismiss","UserPoliciesStateModal","username","props","accepted_at","join","initializers","models","User","seeFlagrowTermsPoliciesState","addAcceptModal","addFieldsToRegister","addUpdateAlert","addUserPoliciesStateControl"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/common';\nexport * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","export default function (items, attr = 'sort') {\n    return items.sort(\n        (a, b) => a[attr]() - b[attr]()\n    );\n}\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\nimport computed from 'flarum/utils/computed';\n\nexport default class Policy extends mixin(Model, {\n    sort: Model.attribute('sort'),\n    name: Model.attribute('name'),\n    url: Model.attribute('url'),\n    update_message: Model.attribute('update_message'),\n    terms_updated_at: Model.attribute('terms_updated_at', Model.transformDate),\n    form_key: computed('id', id => 'flagrow_terms_policy_' + id),\n}) {\n    /**\n     * @inheritDoc\n     */\n    apiEndpoint() {\n        return '/flagrow/terms/policies' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport Page from 'flarum/components/Page';\nimport IndexPage from 'flarum/components/IndexPage';\nimport AcceptPoliciesModal from './components/AcceptPoliciesModal';\n\nexport default function () {\n    let initialized = false;\n\n    extend(Page.prototype, 'init', function () {\n        if (initialized) {\n            return;\n        }\n\n        // We only show the modal if the first page loaded was the index page\n        // And that new updates are available\n        // And that the user *must* accept them\n        if (app.current instanceof IndexPage) {\n            const user = app.session.user;\n\n            if (user && user.flagrowTermsPoliciesMustAccept()) {\n                app.modal.show(new AcceptPoliciesModal());\n            }\n        }\n\n        initialized = true;\n    });\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport SignUpModal from 'flarum/components/SignUpModal';\nimport sortByAttribute from '../common/helpers/sortByAttribute';\n\nexport default function () {\n    extend(SignUpModal.prototype, 'init', function () {\n        this.flagrowTermsPolicies = sortByAttribute(app.store.all('flagrow-terms-policies'));\n\n        this.flagrowTermsPolicies.forEach(policy => {\n            this[policy.form_key()] = m.prop(false);\n        });\n    });\n\n    extend(SignUpModal.prototype, 'body', function (children) {\n        let additionalContent = [];\n\n        const legalText = app.forum.attribute('flagrow-terms.signup-legal-text');\n\n        if (legalText) {\n            additionalContent.push(m('.Form-group', m('.Flagrow-Terms-SignUp-Legal.Alert', legalText)));\n        }\n\n        this.flagrowTermsPolicies.forEach(policy => {\n            additionalContent.push(m('.Form-group', m('.Flagrow-Terms-Check.Flagrow-Terms-Check--signup', m('label.checkbox', [\n                m('input', {\n                    type: 'checkbox',\n                    bidi: this[policy.form_key()],\n                    disabled: this.loading,\n                }),\n                app.translator.trans('flagrow-terms.forum.signup.i-accept', {\n                    policy: policy.name(),\n                    a: policy.url() ? m('a', {\n                        href: policy.url(),\n                        target: '_blank',\n                    }) : m('span'),\n                }),\n            ]))));\n        });\n\n        let fieldsAdded = false;\n\n        // Add the new content inside the Form element, at the second-to-last position (last is submit button)\n        children.forEach(child => {\n            // Only ever add the fields once\n            // Otherwise there could be some Mithril templating issues\n            if (fieldsAdded) {\n                return;\n            }\n\n            if (child.attrs && child.attrs.className && child.attrs.className.indexOf('Form') !== -1) {\n                child.children.splice(child.children.length - 1, 0, additionalContent);\n\n                fieldsAdded = true;\n            }\n        });\n\n        if (!fieldsAdded) {\n            console.error('Could not insert flagrow/terms fields into SignUpModal');\n        }\n    });\n\n    extend(SignUpModal.prototype, 'submitData', function (data) {\n        this.flagrowTermsPolicies.forEach(policy => {\n            data[policy.form_key()] = this[policy.form_key()]();\n        });\n    });\n}\n","import {override} from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport UserPage from 'flarum/components/UserPage';\nimport UpdateAlert from './components/UpdateAlert';\n\n// This single method will be used to inject the alert into existing components\n// If the view is already an array, we add our content at the start\n// If it isn't an array we wrap the content into a new array\nfunction addAlertToContent(original) {\n    const existing = original();\n    const additional = UpdateAlert.component();\n\n    // if the existing content is an array, add to it\n    // This should only happen with the hero() override as other extensions might return an array there\n    if (Array.isArray(existing)) {\n        existing.unshift(additional);\n\n        return existing;\n    }\n\n    // Otherwise return a new list of elements\n    // Use a container div otherwise when extending view() this will prevent the config() method from running\n    // as the Component class won't be able to bind config() to an array\n    // We could also add to vnode.children but this could cause weird styling if another extension or custom styles\n    // change the look of the base page content by targeting the original view root element based on its class\n    // By using a new outer container we make sure the alert always stays full width and unaffected by the page view under it\n    return m('div', [\n        additional,\n        existing,\n    ]);\n}\n\nexport default function () {\n    // There's no single place we can inject the banner\n    // So we use a few different points so it's visible on most pages\n    override(IndexPage.prototype, 'hero', addAlertToContent);\n    override(DiscussionPage.prototype, 'view', addAlertToContent);\n\n    // Covers user profile and settings\n    override(UserPage.prototype, 'view', addAlertToContent);\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport UserControls from 'flarum/utils/UserControls';\nimport Button from 'flarum/components/Button';\nimport UserPoliciesStateModal from './components/UserPoliciesStateModal';\n\nexport default function () {\n    extend(UserControls, 'moderationControls', (items, user) => {\n        if (app.forum.attribute('flagrow-terms.canSeeUserPoliciesState')) {\n            items.add('flagrow-terms.state', Button.component({\n                icon: 'fas fa-paperclip',\n                children: app.translator.trans('flagrow-terms.forum.user_controls.state_button'),\n                onclick() {\n                    app.modal.show(new UserPoliciesStateModal({user}));\n                },\n            }));\n        }\n    });\n}\n","import app from 'flarum/app';\nimport Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport sortByAttribute from '../../common/helpers/sortByAttribute';\n\nexport default class AcceptPoliciesModal extends Modal {\n    init() {\n        super.init();\n\n        app.store.all('flagrow-terms-policies').forEach(policy => {\n            this[policy.form_key()] = m.prop(false);\n        });\n    }\n\n    title() {\n        return app.translator.trans('flagrow-terms.forum.accept-modal.title');\n    }\n\n    content() {\n        return m('.Modal-body', this.body());\n    }\n\n    body() {\n        const policies = sortByAttribute(app.store.all('flagrow-terms-policies').filter(policy => {\n            const state = app.session.user.flagrowTermsPoliciesState()[policy.id()];\n\n            return !state || state.has_update;\n        }));\n\n        if (policies.length === 0) {\n            return Button.component({\n                children: app.translator.trans('flagrow-terms.forum.accept-modal.close'),\n                onclick() {\n                    app.modal.close();\n                },\n            });\n        }\n\n        return policies.map(policy => m('div', [\n            m('h2', policy.name()),\n            (app.forum.attribute('flagrow-terms.hide-updated-at') ? null : m('p', policy.terms_updated_at() ? app.translator.trans('flagrow-terms.forum.accept-modal.updated-at', {\n                date: moment(policy.terms_updated_at()).format(app.forum.attribute('flagrow-terms.date-format')),\n            }) : app.translator.trans('flagrow-terms.forum.accept-modal.updated-recently'))),\n            (policy.update_message() ? m('p', policy.update_message()) : null),\n            m('.Form-group', m('.Flagrow-Terms-Check.Flagrow-Terms-Check--login', m('label.checkbox', [\n                m('input', {\n                    type: 'checkbox',\n                    bidi: this[policy.form_key()],\n                }),\n                app.translator.trans('flagrow-terms.forum.accept-modal.i-accept', {\n                    policy: policy.name(),\n                    a: policy.url() ? m('a', {\n                        href: policy.url(),\n                        target: '_blank',\n                    }) : m('span'),\n                }),\n            ]))),\n            Button.component({\n                className: 'Button Button--primary',\n                children: app.translator.trans('flagrow-terms.forum.accept-modal.accept'),\n                disabled: !this[policy.form_key()](),\n                onclick: () => {\n                    app.request({\n                        url: app.forum.attribute('apiUrl') + policy.apiEndpoint() + '/accept',\n                        method: 'POST',\n                        errorHandler: this.onerror.bind(this)\n                    }).then(updated => {\n                        app.store.pushPayload(updated);\n\n                        // If this was the last policy to accept, close the modal\n                        if (policies.length === 1) {\n                            app.modal.close();\n                        }\n\n                        m.redraw();\n                    });\n                },\n            }),\n        ]));\n    }\n}\n","import app from 'flarum/app';\nimport Component from 'flarum/Component';\nimport Alert from 'flarum/components/Alert';\nimport Button from 'flarum/components/Button';\nimport AcceptPoliciesModal from './AcceptPoliciesModal';\n\nclass AlertWithContainer extends Alert {\n    view() {\n        const vdom = super.view();\n\n        vdom.children = [\n            m('.container', vdom.children),\n        ];\n\n        return vdom;\n    }\n}\n\nlet temporarilyHidden = false;\n\nexport default class UpdateAlert extends Component {\n    shouldShowAlert() {\n        if (temporarilyHidden) {\n            return false;\n        }\n\n        const user = app.session.user;\n\n        return user && user.flagrowTermsPoliciesHasUpdate();\n    }\n\n    view() {\n        if (!this.shouldShowAlert()) {\n            return m('div');\n        }\n\n        return AlertWithContainer.component({\n            type: 'info',\n            children: app.session.user.flagrowTermsPoliciesMustAccept() ?\n                app.translator.trans('flagrow-terms.forum.update-alert.must-accept-message') :\n                app.translator.trans('flagrow-terms.forum.update-alert.can-accept-message'),\n            controls: [\n                Button.component({\n                    className: 'Button Button--link',\n                    children: app.translator.trans('flagrow-terms.forum.update-alert.review'),\n                    onclick: () => {\n                        app.modal.show(new AcceptPoliciesModal());\n                    },\n                }),\n            ],\n            dismissible: !app.session.user.flagrowTermsPoliciesMustAccept(),\n            ondismiss() {\n                temporarilyHidden = true;\n            },\n        });\n    }\n}\n","import app from 'flarum/app';\nimport Modal from 'flarum/components/Modal';\nimport sortByAttribute from '../../common/helpers/sortByAttribute';\n\nexport default class UserPoliciesStateModal extends Modal {\n    init() {\n        super.init();\n    }\n\n    title() {\n        return app.translator.trans('flagrow-terms.forum.state-modal.title', {\n            username: this.props.user.username(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m('ul', sortByAttribute(app.store.all('flagrow-terms-policies')).map(policy => {\n            const state = this.props.user.flagrowTermsPoliciesState()[policy.id()];\n\n            return m('li', policy.name() + ': ' + (state && state.accepted_at ? app.translator.trans('flagrow-terms.forum.state-modal.accepted-at', {\n                date: moment(state.accepted_at).format(app.forum.attribute('flagrow-terms.date-format')) + ' (' + state.accepted_at + ')',\n            }).join('') : app.translator.trans('flagrow-terms.forum.state-modal.not-accepted')));\n        })));\n    }\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport Model from 'flarum/Model';\nimport User from 'flarum/models/User';\nimport Policy from '../common/models/Policy';\nimport addAcceptModal from './addAcceptModal';\nimport addFieldsToRegister from './addFieldsToRegister';\nimport addUpdateAlert from './addUpdateAlert';\nimport addUserPoliciesStateControl from './addUserPoliciesStateControl';\n\napp.initializers.add('flagrow-terms', () => {\n    app.store.models['flagrow-terms-policies'] = Policy;\n\n    User.prototype.flagrowTermsPoliciesState = Model.attribute('flagrowTermsPoliciesState');\n    User.prototype.flagrowTermsPoliciesHasUpdate = Model.attribute('flagrowTermsPoliciesHasUpdate');\n    User.prototype.flagrowTermsPoliciesMustAccept = Model.attribute('flagrowTermsPoliciesMustAccept');\n    User.prototype.seeFlagrowTermsPoliciesState = Model.attribute('seeFlagrowTermsPoliciesState');\n\n    addAcceptModal();\n    addFieldsToRegister();\n    addUpdateAlert();\n    addUserPoliciesStateControl();\n});\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/SignUpModal'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['utils/UserControls'];","module.exports = flarum.core.compat['utils/computed'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}