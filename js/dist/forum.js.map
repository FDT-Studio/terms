{"version":3,"sources":["webpack://@flagrow/terms/webpack/bootstrap","webpack://@flagrow/terms/./forum.js","webpack://@flagrow/terms/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flagrow/terms/./src/common/helpers/sortByAttribute.js","webpack://@flagrow/terms/./src/common/models/Policy.js","webpack://@flagrow/terms/./src/forum/addAcceptModal.js","webpack://@flagrow/terms/./src/forum/addFieldsToRegister.js","webpack://@flagrow/terms/./src/forum/addUpdateAlert.js","webpack://@flagrow/terms/./src/forum/addUserPoliciesStateControl.js","webpack://@flagrow/terms/./src/forum/components/AcceptPoliciesModal.js","webpack://@flagrow/terms/./src/forum/components/UpdateAlert.js","webpack://@flagrow/terms/./src/forum/components/UserPoliciesStateModal.js","webpack://@flagrow/terms/./src/forum/index.js","webpack://@flagrow/terms/external \"flarum.core.compat['Component']\"","webpack://@flagrow/terms/external \"flarum.core.compat['Model']\"","webpack://@flagrow/terms/external \"flarum.core.compat['app']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/Alert']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/Button']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/IndexPage']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/Modal']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/Page']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/SignUpModal']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/UserPage']\"","webpack://@flagrow/terms/external \"flarum.core.compat['extend']\"","webpack://@flagrow/terms/external \"flarum.core.compat['models/User']\"","webpack://@flagrow/terms/external \"flarum.core.compat['utils/UserControls']\"","webpack://@flagrow/terms/external \"flarum.core.compat['utils/computed']\"","webpack://@flagrow/terms/external \"flarum.core.compat['utils/mixin']\""],"names":["items","attr","sort","a","b","Policy","apiEndpoint","exists","data","id","mixin","Model","attribute","name","url","update_message","terms_updated_at","form_key","computed","initialized","extend","Page","prototype","app","current","IndexPage","user","session","flagrowTermsPoliciesMustAccept","modal","show","AcceptPoliciesModal","SignUpModal","flagrowTermsPolicies","sortByAttribute","store","all","forEach","policy","m","prop","fields","legalText","forum","add","type","bidi","disabled","loading","translator","trans","href","target","addAlertToContent","original","existing","additional","UpdateAlert","component","Array","isArray","unshift","override","DiscussionPage","UserPage","UserControls","Button","icon","children","onclick","UserPoliciesStateModal","init","title","content","body","policies","filter","state","flagrowTermsPoliciesState","has_update","length","close","map","date","moment","format","className","request","method","errorHandler","onerror","bind","then","updated","pushPayload","redraw","Modal","AlertWithContainer","view","vdom","Alert","temporarilyHidden","shouldShowAlert","flagrowTermsPoliciesHasUpdate","controls","dismissible","ondismiss","Component","username","props","accepted_at","join","initializers","models","User","seeFlagrowTermsPoliciesState","addAcceptModal","addFieldsToRegister","addUpdateAlert","addUserPoliciesStateControl"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/common';\nexport * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","export default function (items, attr = 'sort') {\n    return items.sort(\n        (a, b) => a[attr]() - b[attr]()\n    );\n}\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\nimport computed from 'flarum/utils/computed';\n\nexport default class Policy extends mixin(Model, {\n    sort: Model.attribute('sort'),\n    name: Model.attribute('name'),\n    url: Model.attribute('url'),\n    update_message: Model.attribute('update_message'),\n    terms_updated_at: Model.attribute('terms_updated_at'),\n    form_key: computed('id', id => 'flagrow_terms_policy_' + id),\n}) {\n    /**\n     * @inheritDoc\n     */\n    apiEndpoint() {\n        return '/flagrow/terms/policies' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport Page from 'flarum/components/Page';\nimport IndexPage from 'flarum/components/IndexPage';\nimport AcceptPoliciesModal from './components/AcceptPoliciesModal';\n\nexport default function () {\n    let initialized = false;\n\n    extend(Page.prototype, 'init', function () {\n        if (initialized) {\n            return;\n        }\n\n        // We only show the modal if the first page loaded was the index page\n        // And that new updates are available\n        // And that the user *must* accept them\n        if (app.current instanceof IndexPage) {\n            const user = app.session.user;\n\n            if (user && user.flagrowTermsPoliciesMustAccept()) {\n                app.modal.show(new AcceptPoliciesModal());\n            }\n        }\n\n        initialized = true;\n    });\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport SignUpModal from 'flarum/components/SignUpModal';\nimport sortByAttribute from '../common/helpers/sortByAttribute';\n\nexport default function () {\n    extend(SignUpModal.prototype, 'init', function () {\n        this.flagrowTermsPolicies = sortByAttribute(app.store.all('flagrow-terms-policies'));\n\n        this.flagrowTermsPolicies.forEach(policy => {\n            this[policy.form_key()] = m.prop(false);\n        });\n    });\n\n    extend(SignUpModal.prototype, 'fields', function (fields) {\n        const legalText = app.forum.attribute('flagrow-terms.signup-legal-text');\n\n        if (legalText) {\n            fields.add('flagrow-terms-legal-text', m('.Form-group', m('.Flagrow-Terms-SignUp-Legal.Alert', legalText)));\n        }\n\n        this.flagrowTermsPolicies.forEach(policy => {\n            fields.add('flagrow-terms-policy-' + policy.id(), m('.Form-group', m('.Flagrow-Terms-Check.Flagrow-Terms-Check--signup', m('label.checkbox', [\n                m('input', {\n                    type: 'checkbox',\n                    bidi: this[policy.form_key()],\n                    disabled: this.loading,\n                }),\n                app.translator.trans('flagrow-terms.forum.signup.i-accept', {\n                    policy: policy.name(),\n                    a: policy.url() ? m('a', {\n                        href: policy.url(),\n                        target: '_blank',\n                    }) : m('span'),\n                }),\n            ]))));\n        });\n    });\n\n    extend(SignUpModal.prototype, 'submitData', function (data) {\n        this.flagrowTermsPolicies.forEach(policy => {\n            data[policy.form_key()] = this[policy.form_key()]();\n        });\n    });\n}\n","import {override} from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport UserPage from 'flarum/components/UserPage';\nimport UpdateAlert from './components/UpdateAlert';\n\n// This single method will be used to inject the alert into existing components\n// If the view is already an array, we add our content at the start\n// If it isn't an array we wrap the content into a new array\nfunction addAlertToContent(original) {\n    const existing = original();\n    const additional = UpdateAlert.component();\n\n    // if the existing content is an array, add to it\n    // This should only happen with the hero() override as other extensions might return an array there\n    if (Array.isArray(existing)) {\n        existing.unshift(additional);\n\n        return existing;\n    }\n\n    // Otherwise return a new list of elements\n    // Use a container div otherwise when extending view() this will prevent the config() method from running\n    // as the Component class won't be able to bind config() to an array\n    // We could also add to vnode.children but this could cause weird styling if another extension or custom styles\n    // change the look of the base page content by targeting the original view root element based on its class\n    // By using a new outer container we make sure the alert always stays full width and unaffected by the page view under it\n    return m('div', [\n        additional,\n        existing,\n    ]);\n}\n\nexport default function () {\n    // There's no single place we can inject the banner\n    // So we use a few different points so it's visible on most pages\n    override(IndexPage.prototype, 'hero', addAlertToContent);\n    override(DiscussionPage.prototype, 'view', addAlertToContent);\n\n    // Covers user profile and settings\n    override(UserPage.prototype, 'view', addAlertToContent);\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport UserControls from 'flarum/utils/UserControls';\nimport Button from 'flarum/components/Button';\nimport UserPoliciesStateModal from './components/UserPoliciesStateModal';\n\nexport default function () {\n    extend(UserControls, 'moderationControls', (items, user) => {\n        if (app.forum.attribute('flagrow-terms.canSeeUserPoliciesState')) {\n            items.add('flagrow-terms.state', Button.component({\n                icon: 'fas fa-paperclip',\n                children: app.translator.trans('flagrow-terms.forum.user_controls.state_button'),\n                onclick() {\n                    app.modal.show(new UserPoliciesStateModal({user}));\n                },\n            }));\n        }\n    });\n}\n","import app from 'flarum/app';\nimport Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport sortByAttribute from '../../common/helpers/sortByAttribute';\n\nexport default class AcceptPoliciesModal extends Modal {\n    init() {\n        super.init();\n\n        app.store.all('flagrow-terms-policies').forEach(policy => {\n            this[policy.form_key()] = m.prop(false);\n        });\n    }\n\n    title() {\n        return app.translator.trans('flagrow-terms.forum.accept-modal.title');\n    }\n\n    content() {\n        return m('.Modal-body', this.body());\n    }\n\n    body() {\n        const policies = sortByAttribute(app.store.all('flagrow-terms-policies').filter(policy => {\n            const state = app.session.user.flagrowTermsPoliciesState()[policy.id()];\n\n            return !state || state.has_update;\n        }));\n\n        if (policies.length === 0) {\n            return Button.component({\n                children: app.translator.trans('flagrow-terms.forum.accept-modal.close'),\n                onclick() {\n                    app.modal.close();\n                },\n            });\n        }\n\n        return policies.map(policy => m('div', [\n            m('h2', policy.name()),\n            (app.forum.attribute('flagrow-terms.hide-updated-at') ? null : m('p', policy.terms_updated_at() ? app.translator.trans('flagrow-terms.forum.accept-modal.updated-at', {\n                date: moment(policy.terms_updated_at()).format(app.forum.attribute('flagrow-terms.date-format')),\n            }) : app.translator.trans('flagrow-terms.forum.accept-modal.updated-recently'))),\n            (policy.update_message() ? m('p', policy.update_message()) : null),\n            m('.Form-group', m('.Flagrow-Terms-Check.Flagrow-Terms-Check--login', m('label.checkbox', [\n                m('input', {\n                    type: 'checkbox',\n                    bidi: this[policy.form_key()],\n                }),\n                app.translator.trans('flagrow-terms.forum.accept-modal.i-accept', {\n                    policy: policy.name(),\n                    a: policy.url() ? m('a', {\n                        href: policy.url(),\n                        target: '_blank',\n                    }) : m('span'),\n                }),\n            ]))),\n            Button.component({\n                className: 'Button Button--primary',\n                children: app.translator.trans('flagrow-terms.forum.accept-modal.accept'),\n                disabled: !this[policy.form_key()](),\n                onclick: () => {\n                    app.request({\n                        url: app.forum.attribute('apiUrl') + policy.apiEndpoint() + '/accept',\n                        method: 'POST',\n                        errorHandler: this.onerror.bind(this)\n                    }).then(updated => {\n                        app.store.pushPayload(updated);\n\n                        // If this was the last policy to accept, close the modal\n                        if (policies.length === 1) {\n                            app.modal.close();\n                        }\n\n                        m.redraw();\n                    });\n                },\n            }),\n        ]));\n    }\n}\n","import app from 'flarum/app';\nimport Component from 'flarum/Component';\nimport Alert from 'flarum/components/Alert';\nimport Button from 'flarum/components/Button';\nimport AcceptPoliciesModal from './AcceptPoliciesModal';\n\nclass AlertWithContainer extends Alert {\n    view() {\n        const vdom = super.view();\n\n        vdom.children = [\n            m('.container', vdom.children),\n        ];\n\n        return vdom;\n    }\n}\n\nlet temporarilyHidden = false;\n\nexport default class UpdateAlert extends Component {\n    shouldShowAlert() {\n        if (temporarilyHidden) {\n            return false;\n        }\n\n        const user = app.session.user;\n\n        return user && user.flagrowTermsPoliciesHasUpdate();\n    }\n\n    view() {\n        if (!this.shouldShowAlert()) {\n            return m('div');\n        }\n\n        return AlertWithContainer.component({\n            type: 'info',\n            children: app.session.user.flagrowTermsPoliciesMustAccept() ?\n                app.translator.trans('flagrow-terms.forum.update-alert.must-accept-message') :\n                app.translator.trans('flagrow-terms.forum.update-alert.can-accept-message'),\n            controls: [\n                Button.component({\n                    className: 'Button Button--link',\n                    children: app.translator.trans('flagrow-terms.forum.update-alert.review'),\n                    onclick: () => {\n                        app.modal.show(new AcceptPoliciesModal());\n                    },\n                }),\n            ],\n            dismissible: !app.session.user.flagrowTermsPoliciesMustAccept(),\n            ondismiss() {\n                temporarilyHidden = true;\n            },\n        });\n    }\n}\n","import app from 'flarum/app';\nimport Modal from 'flarum/components/Modal';\nimport sortByAttribute from '../../common/helpers/sortByAttribute';\n\nexport default class UserPoliciesStateModal extends Modal {\n    init() {\n        super.init();\n    }\n\n    title() {\n        return app.translator.trans('flagrow-terms.forum.state-modal.title', {\n            username: this.props.user.username(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m('ul', sortByAttribute(app.store.all('flagrow-terms-policies')).map(policy => {\n            const state = this.props.user.flagrowTermsPoliciesState()[policy.id()];\n\n            return m('li', policy.name() + ': ' + (state && state.accepted_at ? app.translator.trans('flagrow-terms.forum.state-modal.accepted-at', {\n                date: moment(state.accepted_at).format(app.forum.attribute('flagrow-terms.date-format')) + ' (' + state.accepted_at + ')',\n            }).join('') : app.translator.trans('flagrow-terms.forum.state-modal.not-accepted')));\n        })));\n    }\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport Model from 'flarum/Model';\nimport User from 'flarum/models/User';\nimport Policy from '../common/models/Policy';\nimport addAcceptModal from './addAcceptModal';\nimport addFieldsToRegister from './addFieldsToRegister';\nimport addUpdateAlert from './addUpdateAlert';\nimport addUserPoliciesStateControl from './addUserPoliciesStateControl';\n\napp.initializers.add('flagrow-terms', () => {\n    app.store.models['flagrow-terms-policies'] = Policy;\n\n    User.prototype.flagrowTermsPoliciesState = Model.attribute('flagrowTermsPoliciesState');\n    User.prototype.flagrowTermsPoliciesHasUpdate = Model.attribute('flagrowTermsPoliciesHasUpdate');\n    User.prototype.flagrowTermsPoliciesMustAccept = Model.attribute('flagrowTermsPoliciesMustAccept');\n    User.prototype.seeFlagrowTermsPoliciesState = Model.attribute('seeFlagrowTermsPoliciesState');\n\n    addAcceptModal();\n    addFieldsToRegister();\n    addUpdateAlert();\n    addUserPoliciesStateControl();\n});\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/SignUpModal'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['utils/UserControls'];","module.exports = flarum.core.compat['utils/computed'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}