{"version":3,"sources":["webpack://@flagrow/terms/webpack/bootstrap","webpack://@flagrow/terms/./admin.js","webpack://@flagrow/terms/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flagrow/terms/./node_modules/jquery-sortable/source/js/jquery-sortable.js","webpack://@flagrow/terms/./src/admin/addPermissions.js","webpack://@flagrow/terms/./src/admin/components/PolicyEdit.js","webpack://@flagrow/terms/./src/admin/components/PolicyList.js","webpack://@flagrow/terms/./src/admin/components/TermsSettingsModal.js","webpack://@flagrow/terms/./src/admin/index.js","webpack://@flagrow/terms/./src/common/helpers/sortByAttribute.js","webpack://@flagrow/terms/./src/common/models/Policy.js","webpack://@flagrow/terms/external \"flarum.core.compat['Component']\"","webpack://@flagrow/terms/external \"flarum.core.compat['Model']\"","webpack://@flagrow/terms/external \"flarum.core.compat['app']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/Button']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/PermissionGrid']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/SettingsModal']\"","webpack://@flagrow/terms/external \"flarum.core.compat['components/Switch']\"","webpack://@flagrow/terms/external \"flarum.core.compat['extend']\"","webpack://@flagrow/terms/external \"flarum.core.compat['helpers/icon']\"","webpack://@flagrow/terms/external \"flarum.core.compat['utils/computed']\"","webpack://@flagrow/terms/external \"flarum.core.compat['utils/mixin']\""],"names":["extend","PermissionGrid","prototype","items","add","icon","label","app","translator","trans","permission","PolicyEdit","init","policy","props","dirty","processing","toggleFields","initNewField","store","createRecord","attributes","name","url","update_message","terms_updated_at","boxTitle","exists","view","m","onclick","viewFields","type","value","oninput","withAttr","updateAttribute","bind","placeholder","Button","component","className","moment","milliseconds","toISOString","children","map","format","href","forum","attribute","id","target","toUpperCase","a","loading","disabled","readyToSave","savePolicy","deletePolicy","pushAttributes","createNewRecord","save","data","then","redraw","catch","err","confirm","join","delete","Component","PolicyList","request","method","result","pushPayload","config","$","sortable","handle","on","sorting","get","updateSort","policies","all","fieldsList","sortByAttribute","forEach","push","key","sort","settingsPrefix","translationPrefix","TermsSettingsModal","title","form","bidi","setting","Switch","state","onchange","SettingsModal","initializers","models","Policy","extensionSettings","modal","show","addPermissions","attr","b","apiEndpoint","mixin","Model","form_key","computed"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAe;AACf;AACA;AACA;AACA,C;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;;AAE9B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA,8BAA8B;AAC9B;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B;;AAE/B;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC;AACnC;AACA;AACA,WAAW;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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./admin.js\");\n","export * from './src/common';\nexport * from './src/admin';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","/* ===================================================\r\n *  jquery-sortable.js v0.9.13\r\n *  http://johnny.github.com/jquery-sortable/\r\n * ===================================================\r\n *  Copyright (c) 2012 Jonas von Andrian\r\n *  All rights reserved.\r\n *\r\n *  Redistribution and use in source and binary forms, with or without\r\n *  modification, are permitted provided that the following conditions are met:\r\n *  * Redistributions of source code must retain the above copyright\r\n *    notice, this list of conditions and the following disclaimer.\r\n *  * Redistributions in binary form must reproduce the above copyright\r\n *    notice, this list of conditions and the following disclaimer in the\r\n *    documentation and/or other materials provided with the distribution.\r\n *  * The name of the author may not be used to endorse or promote products\r\n *    derived from this software without specific prior written permission.\r\n *\r\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n *  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n *  DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY\r\n *  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n *  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n *  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n *  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n *  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n * ========================================================== */\r\n\r\n!function ( $, window, pluginName, undefined){\r\n  var containerDefaults = {\r\n    // If true, items can be dragged from this container\r\n    drag: true,\r\n    // If true, items can be droped onto this container\r\n    drop: true,\r\n    // Exclude items from being draggable, if the\r\n    // selector matches the item\r\n    exclude: \"\",\r\n    // If true, search for nested containers within an item.If you nest containers,\r\n    // either the original selector with which you call the plugin must only match the top containers,\r\n    // or you need to specify a group (see the bootstrap nav example)\r\n    nested: true,\r\n    // If true, the items are assumed to be arranged vertically\r\n    vertical: true\r\n  }, // end container defaults\r\n  groupDefaults = {\r\n    // This is executed after the placeholder has been moved.\r\n    // $closestItemOrContainer contains the closest item, the placeholder\r\n    // has been put at or the closest empty Container, the placeholder has\r\n    // been appended to.\r\n    afterMove: function ($placeholder, container, $closestItemOrContainer) {\r\n    },\r\n    // The exact css path between the container and its items, e.g. \"> tbody\"\r\n    containerPath: \"\",\r\n    // The css selector of the containers\r\n    containerSelector: \"ol, ul\",\r\n    // Distance the mouse has to travel to start dragging\r\n    distance: 0,\r\n    // Time in milliseconds after mousedown until dragging should start.\r\n    // This option can be used to prevent unwanted drags when clicking on an element.\r\n    delay: 0,\r\n    // The css selector of the drag handle\r\n    handle: \"\",\r\n    // The exact css path between the item and its subcontainers.\r\n    // It should only match the immediate items of a container.\r\n    // No item of a subcontainer should be matched. E.g. for ol>div>li the itemPath is \"> div\"\r\n    itemPath: \"\",\r\n    // The css selector of the items\r\n    itemSelector: \"li\",\r\n    // The class given to \"body\" while an item is being dragged\r\n    bodyClass: \"dragging\",\r\n    // The class giving to an item while being dragged\r\n    draggedClass: \"dragged\",\r\n    // Check if the dragged item may be inside the container.\r\n    // Use with care, since the search for a valid container entails a depth first search\r\n    // and may be quite expensive.\r\n    isValidTarget: function ($item, container) {\r\n      return true\r\n    },\r\n    // Executed before onDrop if placeholder is detached.\r\n    // This happens if pullPlaceholder is set to false and the drop occurs outside a container.\r\n    onCancel: function ($item, container, _super, event) {\r\n    },\r\n    // Executed at the beginning of a mouse move event.\r\n    // The Placeholder has not been moved yet.\r\n    onDrag: function ($item, position, _super, event) {\r\n      $item.css(position)\r\n    },\r\n    // Called after the drag has been started,\r\n    // that is the mouse button is being held down and\r\n    // the mouse is moving.\r\n    // The container is the closest initialized container.\r\n    // Therefore it might not be the container, that actually contains the item.\r\n    onDragStart: function ($item, container, _super, event) {\r\n      $item.css({\r\n        height: $item.outerHeight(),\r\n        width: $item.outerWidth()\r\n      })\r\n      $item.addClass(container.group.options.draggedClass)\r\n      $(\"body\").addClass(container.group.options.bodyClass)\r\n    },\r\n    // Called when the mouse button is being released\r\n    onDrop: function ($item, container, _super, event) {\r\n      $item.removeClass(container.group.options.draggedClass).removeAttr(\"style\")\r\n      $(\"body\").removeClass(container.group.options.bodyClass)\r\n    },\r\n    // Called on mousedown. If falsy value is returned, the dragging will not start.\r\n    // Ignore if element clicked is input, select or textarea\r\n    onMousedown: function ($item, _super, event) {\r\n      if (!event.target.nodeName.match(/^(input|select|textarea)$/i)) {\r\n        event.preventDefault()\r\n        return true\r\n      }\r\n    },\r\n    // The class of the placeholder (must match placeholder option markup)\r\n    placeholderClass: \"placeholder\",\r\n    // Template for the placeholder. Can be any valid jQuery input\r\n    // e.g. a string, a DOM element.\r\n    // The placeholder must have the class \"placeholder\"\r\n    placeholder: '<li class=\"placeholder\"></li>',\r\n    // If true, the position of the placeholder is calculated on every mousemove.\r\n    // If false, it is only calculated when the mouse is above a container.\r\n    pullPlaceholder: true,\r\n    // Specifies serialization of the container group.\r\n    // The pair $parent/$children is either container/items or item/subcontainers.\r\n    serialize: function ($parent, $children, parentIsContainer) {\r\n      var result = $.extend({}, $parent.data())\r\n\r\n      if(parentIsContainer)\r\n        return [$children]\r\n      else if ($children[0]){\r\n        result.children = $children\r\n      }\r\n\r\n      delete result.subContainers\r\n      delete result.sortable\r\n\r\n      return result\r\n    },\r\n    // Set tolerance while dragging. Positive values decrease sensitivity,\r\n    // negative values increase it.\r\n    tolerance: 0\r\n  }, // end group defaults\r\n  containerGroups = {},\r\n  groupCounter = 0,\r\n  emptyBox = {\r\n    left: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    right:0\r\n  },\r\n  eventNames = {\r\n    start: \"touchstart.sortable mousedown.sortable\",\r\n    drop: \"touchend.sortable touchcancel.sortable mouseup.sortable\",\r\n    drag: \"touchmove.sortable mousemove.sortable\",\r\n    scroll: \"scroll.sortable\"\r\n  },\r\n  subContainerKey = \"subContainers\"\r\n\r\n  /*\r\n   * a is Array [left, right, top, bottom]\r\n   * b is array [left, top]\r\n   */\r\n  function d(a,b) {\r\n    var x = Math.max(0, a[0] - b[0], b[0] - a[1]),\r\n    y = Math.max(0, a[2] - b[1], b[1] - a[3])\r\n    return x+y;\r\n  }\r\n\r\n  function setDimensions(array, dimensions, tolerance, useOffset) {\r\n    var i = array.length,\r\n    offsetMethod = useOffset ? \"offset\" : \"position\"\r\n    tolerance = tolerance || 0\r\n\r\n    while(i--){\r\n      var el = array[i].el ? array[i].el : $(array[i]),\r\n      // use fitting method\r\n      pos = el[offsetMethod]()\r\n      pos.left += parseInt(el.css('margin-left'), 10)\r\n      pos.top += parseInt(el.css('margin-top'),10)\r\n      dimensions[i] = [\r\n        pos.left - tolerance,\r\n        pos.left + el.outerWidth() + tolerance,\r\n        pos.top - tolerance,\r\n        pos.top + el.outerHeight() + tolerance\r\n      ]\r\n    }\r\n  }\r\n\r\n  function getRelativePosition(pointer, element) {\r\n    var offset = element.offset()\r\n    return {\r\n      left: pointer.left - offset.left,\r\n      top: pointer.top - offset.top\r\n    }\r\n  }\r\n\r\n  function sortByDistanceDesc(dimensions, pointer, lastPointer) {\r\n    pointer = [pointer.left, pointer.top]\r\n    lastPointer = lastPointer && [lastPointer.left, lastPointer.top]\r\n\r\n    var dim,\r\n    i = dimensions.length,\r\n    distances = []\r\n\r\n    while(i--){\r\n      dim = dimensions[i]\r\n      distances[i] = [i,d(dim,pointer), lastPointer && d(dim, lastPointer)]\r\n    }\r\n    distances = distances.sort(function  (a,b) {\r\n      return b[1] - a[1] || b[2] - a[2] || b[0] - a[0]\r\n    })\r\n\r\n    // last entry is the closest\r\n    return distances\r\n  }\r\n\r\n  function ContainerGroup(options) {\r\n    this.options = $.extend({}, groupDefaults, options)\r\n    this.containers = []\r\n\r\n    if(!this.options.rootGroup){\r\n      this.scrollProxy = $.proxy(this.scroll, this)\r\n      this.dragProxy = $.proxy(this.drag, this)\r\n      this.dropProxy = $.proxy(this.drop, this)\r\n      this.placeholder = $(this.options.placeholder)\r\n\r\n      if(!options.isValidTarget)\r\n        this.options.isValidTarget = undefined\r\n    }\r\n  }\r\n\r\n  ContainerGroup.get = function  (options) {\r\n    if(!containerGroups[options.group]) {\r\n      if(options.group === undefined)\r\n        options.group = groupCounter ++\r\n\r\n      containerGroups[options.group] = new ContainerGroup(options)\r\n    }\r\n\r\n    return containerGroups[options.group]\r\n  }\r\n\r\n  ContainerGroup.prototype = {\r\n    dragInit: function  (e, itemContainer) {\r\n      this.$document = $(itemContainer.el[0].ownerDocument)\r\n\r\n      // get item to drag\r\n      var closestItem = $(e.target).closest(this.options.itemSelector);\r\n      // using the length of this item, prevents the plugin from being started if there is no handle being clicked on.\r\n      // this may also be helpful in instantiating multidrag.\r\n      if (closestItem.length) {\r\n        this.item = closestItem;\r\n        this.itemContainer = itemContainer;\r\n        if (this.item.is(this.options.exclude) || !this.options.onMousedown(this.item, groupDefaults.onMousedown, e)) {\r\n            return;\r\n        }\r\n        this.setPointer(e);\r\n        this.toggleListeners('on');\r\n        this.setupDelayTimer();\r\n        this.dragInitDone = true;\r\n      }\r\n    },\r\n    drag: function  (e) {\r\n      if(!this.dragging){\r\n        if(!this.distanceMet(e) || !this.delayMet)\r\n          return\r\n\r\n        this.options.onDragStart(this.item, this.itemContainer, groupDefaults.onDragStart, e)\r\n        this.item.before(this.placeholder)\r\n        this.dragging = true\r\n      }\r\n\r\n      this.setPointer(e)\r\n      // place item under the cursor\r\n      this.options.onDrag(this.item,\r\n                          getRelativePosition(this.pointer, this.item.offsetParent()),\r\n                          groupDefaults.onDrag,\r\n                          e)\r\n\r\n      var p = this.getPointer(e),\r\n      box = this.sameResultBox,\r\n      t = this.options.tolerance\r\n\r\n      if(!box || box.top - t > p.top || box.bottom + t < p.top || box.left - t > p.left || box.right + t < p.left)\r\n        if(!this.searchValidTarget()){\r\n          this.placeholder.detach()\r\n          this.lastAppendedItem = undefined\r\n        }\r\n    },\r\n    drop: function  (e) {\r\n      this.toggleListeners('off')\r\n\r\n      this.dragInitDone = false\r\n\r\n      if(this.dragging){\r\n        // processing Drop, check if placeholder is detached\r\n        if(this.placeholder.closest(\"html\")[0]){\r\n          this.placeholder.before(this.item).detach()\r\n        } else {\r\n          this.options.onCancel(this.item, this.itemContainer, groupDefaults.onCancel, e)\r\n        }\r\n        this.options.onDrop(this.item, this.getContainer(this.item), groupDefaults.onDrop, e)\r\n\r\n        // cleanup\r\n        this.clearDimensions()\r\n        this.clearOffsetParent()\r\n        this.lastAppendedItem = this.sameResultBox = undefined\r\n        this.dragging = false\r\n      }\r\n    },\r\n    searchValidTarget: function  (pointer, lastPointer) {\r\n      if(!pointer){\r\n        pointer = this.relativePointer || this.pointer\r\n        lastPointer = this.lastRelativePointer || this.lastPointer\r\n      }\r\n\r\n      var distances = sortByDistanceDesc(this.getContainerDimensions(),\r\n                                         pointer,\r\n                                         lastPointer),\r\n      i = distances.length\r\n\r\n      while(i--){\r\n        var index = distances[i][0],\r\n        distance = distances[i][1]\r\n\r\n        if(!distance || this.options.pullPlaceholder){\r\n          var container = this.containers[index]\r\n          if(!container.disabled){\r\n            if(!this.$getOffsetParent()){\r\n              var offsetParent = container.getItemOffsetParent()\r\n              pointer = getRelativePosition(pointer, offsetParent)\r\n              lastPointer = getRelativePosition(lastPointer, offsetParent)\r\n            }\r\n            if(container.searchValidTarget(pointer, lastPointer))\r\n              return true\r\n          }\r\n        }\r\n      }\r\n      if(this.sameResultBox)\r\n        this.sameResultBox = undefined\r\n    },\r\n    movePlaceholder: function  (container, item, method, sameResultBox) {\r\n      var lastAppendedItem = this.lastAppendedItem\r\n      if(!sameResultBox && lastAppendedItem && lastAppendedItem[0] === item[0])\r\n        return;\r\n\r\n      item[method](this.placeholder)\r\n      this.lastAppendedItem = item\r\n      this.sameResultBox = sameResultBox\r\n      this.options.afterMove(this.placeholder, container, item)\r\n    },\r\n    getContainerDimensions: function  () {\r\n      if(!this.containerDimensions)\r\n        setDimensions(this.containers, this.containerDimensions = [], this.options.tolerance, !this.$getOffsetParent())\r\n      return this.containerDimensions\r\n    },\r\n    getContainer: function  (element) {\r\n      return element.closest(this.options.containerSelector).data(pluginName)\r\n    },\r\n    $getOffsetParent: function  () {\r\n      if(this.offsetParent === undefined){\r\n        var i = this.containers.length - 1,\r\n        offsetParent = this.containers[i].getItemOffsetParent()\r\n\r\n        if(!this.options.rootGroup){\r\n          while(i--){\r\n            if(offsetParent[0] != this.containers[i].getItemOffsetParent()[0]){\r\n              // If every container has the same offset parent,\r\n              // use position() which is relative to this parent,\r\n              // otherwise use offset()\r\n              // compare #setDimensions\r\n              offsetParent = false\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        this.offsetParent = offsetParent\r\n      }\r\n      return this.offsetParent\r\n    },\r\n    setPointer: function (e) {\r\n      var pointer = this.getPointer(e)\r\n\r\n      if(this.$getOffsetParent()){\r\n        var relativePointer = getRelativePosition(pointer, this.$getOffsetParent())\r\n        this.lastRelativePointer = this.relativePointer\r\n        this.relativePointer = relativePointer\r\n      }\r\n\r\n      this.lastPointer = this.pointer\r\n      this.pointer = pointer\r\n    },\r\n    distanceMet: function (e) {\r\n      var currentPointer = this.getPointer(e)\r\n      return (Math.max(\r\n        Math.abs(this.pointer.left - currentPointer.left),\r\n        Math.abs(this.pointer.top - currentPointer.top)\r\n      ) >= this.options.distance)\r\n    },\r\n    getPointer: function(e) {\r\n      var o = e.originalEvent || e.originalEvent.touches && e.originalEvent.touches[0]\r\n      return {\r\n        left: e.pageX || o.pageX,\r\n        top: e.pageY || o.pageY\r\n      }\r\n    },\r\n    setupDelayTimer: function () {\r\n      var that = this\r\n      this.delayMet = !this.options.delay\r\n\r\n      // init delay timer if needed\r\n      if (!this.delayMet) {\r\n        clearTimeout(this._mouseDelayTimer);\r\n        this._mouseDelayTimer = setTimeout(function() {\r\n          that.delayMet = true\r\n        }, this.options.delay)\r\n      }\r\n    },\r\n    scroll: function  (e) {\r\n      this.clearDimensions()\r\n      this.clearOffsetParent() // TODO is this needed?\r\n    },\r\n    toggleListeners: function (method) {\r\n      var that = this,\r\n      events = ['drag','drop','scroll']\r\n\r\n      $.each(events,function  (i,event) {\r\n        that.$document[method](eventNames[event], that[event + 'Proxy'])\r\n      })\r\n    },\r\n    clearOffsetParent: function () {\r\n      this.offsetParent = undefined\r\n    },\r\n    // Recursively clear container and item dimensions\r\n    clearDimensions: function  () {\r\n      this.traverse(function(object){\r\n        object._clearDimensions()\r\n      })\r\n    },\r\n    traverse: function(callback) {\r\n      callback(this)\r\n      var i = this.containers.length\r\n      while(i--){\r\n        this.containers[i].traverse(callback)\r\n      }\r\n    },\r\n    _clearDimensions: function(){\r\n      this.containerDimensions = undefined\r\n    },\r\n    _destroy: function () {\r\n      containerGroups[this.options.group] = undefined\r\n    }\r\n  }\r\n\r\n  function Container(element, options) {\r\n    this.el = element\r\n    this.options = $.extend( {}, containerDefaults, options)\r\n\r\n    this.group = ContainerGroup.get(this.options)\r\n    this.rootGroup = this.options.rootGroup || this.group\r\n    this.handle = this.rootGroup.options.handle || this.rootGroup.options.itemSelector\r\n\r\n    var itemPath = this.rootGroup.options.itemPath\r\n    this.target = itemPath ? this.el.find(itemPath) : this.el\r\n\r\n    this.target.on(eventNames.start, this.handle, $.proxy(this.dragInit, this))\r\n\r\n    if(this.options.drop)\r\n      this.group.containers.push(this)\r\n  }\r\n\r\n  Container.prototype = {\r\n    dragInit: function  (e) {\r\n      var rootGroup = this.rootGroup\r\n\r\n      if( !this.disabled &&\r\n          !rootGroup.dragInitDone &&\r\n          this.options.drag &&\r\n          this.isValidDrag(e)) {\r\n        rootGroup.dragInit(e, this)\r\n      }\r\n    },\r\n    isValidDrag: function(e) {\r\n      return e.which == 1 ||\r\n        e.type == \"touchstart\" && e.originalEvent.touches.length == 1\r\n    },\r\n    searchValidTarget: function  (pointer, lastPointer) {\r\n      var distances = sortByDistanceDesc(this.getItemDimensions(),\r\n                                         pointer,\r\n                                         lastPointer),\r\n      i = distances.length,\r\n      rootGroup = this.rootGroup,\r\n      validTarget = !rootGroup.options.isValidTarget ||\r\n        rootGroup.options.isValidTarget(rootGroup.item, this)\r\n\r\n      if(!i && validTarget){\r\n        rootGroup.movePlaceholder(this, this.target, \"append\")\r\n        return true\r\n      } else\r\n        while(i--){\r\n          var index = distances[i][0],\r\n          distance = distances[i][1]\r\n          if(!distance && this.hasChildGroup(index)){\r\n            var found = this.getContainerGroup(index).searchValidTarget(pointer, lastPointer)\r\n            if(found)\r\n              return true\r\n          }\r\n          else if(validTarget){\r\n            this.movePlaceholder(index, pointer)\r\n            return true\r\n          }\r\n        }\r\n    },\r\n    movePlaceholder: function  (index, pointer) {\r\n      var item = $(this.items[index]),\r\n      dim = this.itemDimensions[index],\r\n      method = \"after\",\r\n      width = item.outerWidth(),\r\n      height = item.outerHeight(),\r\n      offset = item.offset(),\r\n      sameResultBox = {\r\n        left: offset.left,\r\n        right: offset.left + width,\r\n        top: offset.top,\r\n        bottom: offset.top + height\r\n      }\r\n      if(this.options.vertical){\r\n        var yCenter = (dim[2] + dim[3]) / 2,\r\n        inUpperHalf = pointer.top <= yCenter\r\n        if(inUpperHalf){\r\n          method = \"before\"\r\n          sameResultBox.bottom -= height / 2\r\n        } else\r\n          sameResultBox.top += height / 2\r\n      } else {\r\n        var xCenter = (dim[0] + dim[1]) / 2,\r\n        inLeftHalf = pointer.left <= xCenter\r\n        if(inLeftHalf){\r\n          method = \"before\"\r\n          sameResultBox.right -= width / 2\r\n        } else\r\n          sameResultBox.left += width / 2\r\n      }\r\n      if(this.hasChildGroup(index))\r\n        sameResultBox = emptyBox\r\n      this.rootGroup.movePlaceholder(this, item, method, sameResultBox)\r\n    },\r\n    getItemDimensions: function  () {\r\n      if(!this.itemDimensions){\r\n        this.items = this.$getChildren(this.el, \"item\").filter(\r\n          \":not(.\" + this.group.options.placeholderClass + \", .\" + this.group.options.draggedClass + \")\"\r\n        ).get()\r\n        setDimensions(this.items, this.itemDimensions = [], this.options.tolerance)\r\n      }\r\n      return this.itemDimensions\r\n    },\r\n    getItemOffsetParent: function  () {\r\n      var offsetParent,\r\n      el = this.el\r\n      // Since el might be empty we have to check el itself and\r\n      // can not do something like el.children().first().offsetParent()\r\n      if(el.css(\"position\") === \"relative\" || el.css(\"position\") === \"absolute\"  || el.css(\"position\") === \"fixed\")\r\n        offsetParent = el\r\n      else\r\n        offsetParent = el.offsetParent()\r\n      return offsetParent\r\n    },\r\n    hasChildGroup: function (index) {\r\n      return this.options.nested && this.getContainerGroup(index)\r\n    },\r\n    getContainerGroup: function  (index) {\r\n      var childGroup = $.data(this.items[index], subContainerKey)\r\n      if( childGroup === undefined){\r\n        var childContainers = this.$getChildren(this.items[index], \"container\")\r\n        childGroup = false\r\n\r\n        if(childContainers[0]){\r\n          var options = $.extend({}, this.options, {\r\n            rootGroup: this.rootGroup,\r\n            group: groupCounter ++\r\n          })\r\n          childGroup = childContainers[pluginName](options).data(pluginName).group\r\n        }\r\n        $.data(this.items[index], subContainerKey, childGroup)\r\n      }\r\n      return childGroup\r\n    },\r\n    $getChildren: function (parent, type) {\r\n      var options = this.rootGroup.options,\r\n      path = options[type + \"Path\"],\r\n      selector = options[type + \"Selector\"]\r\n\r\n      parent = $(parent)\r\n      if(path)\r\n        parent = parent.find(path)\r\n\r\n      return parent.children(selector)\r\n    },\r\n    _serialize: function (parent, isContainer) {\r\n      var that = this,\r\n      childType = isContainer ? \"item\" : \"container\",\r\n\r\n      children = this.$getChildren(parent, childType).not(this.options.exclude).map(function () {\r\n        return that._serialize($(this), !isContainer)\r\n      }).get()\r\n\r\n      return this.rootGroup.options.serialize(parent, children, isContainer)\r\n    },\r\n    traverse: function(callback) {\r\n      $.each(this.items || [], function(item){\r\n        var group = $.data(this, subContainerKey)\r\n        if(group)\r\n          group.traverse(callback)\r\n      });\r\n\r\n      callback(this)\r\n    },\r\n    _clearDimensions: function  () {\r\n      this.itemDimensions = undefined\r\n    },\r\n    _destroy: function() {\r\n      var that = this;\r\n\r\n      this.target.off(eventNames.start, this.handle);\r\n      this.el.removeData(pluginName)\r\n\r\n      if(this.options.drop)\r\n        this.group.containers = $.grep(this.group.containers, function(val){\r\n          return val != that\r\n        })\r\n\r\n      $.each(this.items || [], function(){\r\n        $.removeData(this, subContainerKey)\r\n      })\r\n    }\r\n  }\r\n\r\n  var API = {\r\n    enable: function() {\r\n      this.traverse(function(object){\r\n        object.disabled = false\r\n      })\r\n    },\r\n    disable: function (){\r\n      this.traverse(function(object){\r\n        object.disabled = true\r\n      })\r\n    },\r\n    serialize: function () {\r\n      return this._serialize(this.el, true)\r\n    },\r\n    refresh: function() {\r\n      this.traverse(function(object){\r\n        object._clearDimensions()\r\n      })\r\n    },\r\n    destroy: function () {\r\n      this.traverse(function(object){\r\n        object._destroy();\r\n      })\r\n    }\r\n  }\r\n\r\n  $.extend(Container.prototype, API)\r\n\r\n  /**\r\n   * jQuery API\r\n   *\r\n   * Parameters are\r\n   *   either options on init\r\n   *   or a method name followed by arguments to pass to the method\r\n   */\r\n  $.fn[pluginName] = function(methodOrOptions) {\r\n    var args = Array.prototype.slice.call(arguments, 1)\r\n\r\n    return this.map(function(){\r\n      var $t = $(this),\r\n      object = $t.data(pluginName)\r\n\r\n      if(object && API[methodOrOptions])\r\n        return API[methodOrOptions].apply(object, args) || this\r\n      else if(!object && (methodOrOptions === undefined ||\r\n                          typeof methodOrOptions === \"object\"))\r\n        $t.data(pluginName, new Container($t, methodOrOptions))\r\n\r\n      return this\r\n    });\r\n  };\r\n\r\n}(jQuery, window, 'sortable');\r\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport PermissionGrid from 'flarum/components/PermissionGrid';\n\nexport default function () {\n    extend(PermissionGrid.prototype, 'moderateItems', items => {\n        items.add('flagrow-terms-see-user-policies-state', {\n            icon: 'fas fa-paperclip',\n            label: app.translator.trans('flagrow-terms.admin.permissions.see-user-policies-state'),\n            permission: 'flagrow-terms.see-user-policies-state',\n        });\n\n        items.add('flagrow-terms-postpone-policies-accept', {\n            icon: 'fas fa-paperclip',\n            label: app.translator.trans('flagrow-terms.admin.permissions.postpone-policies-accept'),\n            permission: 'flagrow-terms.postpone-policies-accept',\n        });\n\n        items.add('flagrow-terms-export-policies', {\n            icon: 'fas fa-paperclip',\n            label: app.translator.trans('flagrow-terms.admin.permissions.export-policies'),\n            permission: 'flagrow-terms.export-policies',\n        });\n    });\n}\n","import app from 'flarum/app';\nimport icon from 'flarum/helpers/icon';\nimport Component from 'flarum/Component';\nimport Button from 'flarum/components/Button';\n\nexport default class PolicyEdit extends Component {\n    init() {\n        this.policy = this.props.policy;\n        this.dirty = false;\n        this.processing = false;\n        this.toggleFields = false;\n\n        if (this.policy === null) {\n            this.initNewField();\n        }\n    }\n\n    initNewField() {\n        this.policy = app.store.createRecord('flagrow-terms-policies', {\n            attributes: {\n                name: '',\n                url: '',\n                update_message: '',\n                terms_updated_at: '',\n            },\n        });\n    }\n\n    boxTitle() {\n        if (this.policy.exists) {\n            return this.policy.name();\n        }\n\n        return app.translator.trans('flagrow-terms.admin.buttons.new-policy');\n    }\n\n    view() {\n        return m('.Flagrow-Terms-Policiy-Box', [\n            (this.policy.exists ? m('span.fas.fa-arrows-alt.Flagrow-Terms-Policiy-Box--handle.js-policy-handle') : null),\n            m('.Button.Button--block.Flagrow-Terms-Policiy-Header', {\n                onclick: () => {\n                    this.toggleFields = !this.toggleFields;\n                },\n            }, [\n                m('.Flagrow-Terms-Policiy-Header-Title', this.boxTitle()),\n                m('div', [\n                    (this.policy.exists ? [\n                        app.translator.trans('flagrow-terms.admin.buttons.edit-policy'),\n                        ' ',\n                    ] : null),\n                    icon(this.toggleFields ? 'fas fa-chevron-up' : 'fas fa-chevron-down'),\n                ]),\n            ]),\n            (this.toggleFields ? this.viewFields() : null),\n        ]);\n    }\n\n    viewFields() {\n        return m('form.Flagrow-Terms-Policiy-Body', [\n            m('.Form-group', [\n                m('label', app.translator.trans('flagrow-terms.admin.policies.name')),\n                m('input.FormControl', {\n                    type: 'text',\n                    value: this.policy.name(),\n                    oninput: m.withAttr('value', this.updateAttribute.bind(this, 'name')),\n                }),\n                m('.helpText', app.translator.trans('flagrow-terms.admin.policies.name-help')),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans('flagrow-terms.admin.policies.url')),\n                m('input.FormControl', {\n                    type: 'url',\n                    value: this.policy.url(),\n                    oninput: m.withAttr('value', this.updateAttribute.bind(this, 'url')),\n                }),\n                m('.helpText', app.translator.trans('flagrow-terms.admin.policies.url-help')),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans('flagrow-terms.admin.policies.update-message')),\n                m('textarea.FormControl', {\n                    value: this.policy.update_message(),\n                    oninput: m.withAttr('value', this.updateAttribute.bind(this, 'update_message')),\n                }),\n                m('.helpText', app.translator.trans('flagrow-terms.admin.policies.update-message-help')),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans('flagrow-terms.admin.policies.terms-updated-at')),\n                m('.Flagrow-Terms-Input-Group', [\n                    m('input.FormControl', {\n                        type: 'text',\n                        value: this.policy.terms_updated_at(),\n                        oninput: m.withAttr('value', this.updateAttribute.bind(this, 'terms_updated_at')),\n                        placeholder: app.translator.trans('flagrow-terms.admin.policies.terms-updated-at-placeholder'),\n                    }),\n                    Button.component({\n                        className: 'Button Button--primary',\n                        onclick: () => {\n                            this.updateAttribute('terms_updated_at', moment().milliseconds(0).toISOString());\n                        },\n                        children: app.translator.trans('flagrow-terms.admin.buttons.set-to-now'),\n                    }),\n                ]),\n                m('.helpText', app.translator.trans('flagrow-terms.admin.policies.terms-updated-at-help')),\n            ]),\n            (this.policy.exists ? m('.Form-group', [\n                m('label', app.translator.trans('flagrow-terms.admin.policies.export-url')),\n                m('.ButtonGroup', ['json', 'csv'].map(format => m('a.Button.Flagrow-Terms-Export-Button', {\n                    href: app.forum.attribute('apiUrl') + '/flagrow/terms/policies/' + this.policy.id() + '/export.' + format,\n                    target: '_blank',\n                }, format.toUpperCase()))),\n                m('.helpText', app.translator.trans('flagrow-terms.admin.policies.export-url-help', {\n                    a: m('a', {\n                        href: 'https://github.com/flagrow/terms/wiki/Export-url',\n                        target: '_blank',\n                    }),\n                })),\n            ]) : null),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    children: app.translator.trans('flagrow-terms.admin.buttons.' + (this.policy.exists ? 'save' : 'add') + '-policy'),\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                    onclick: this.savePolicy.bind(this),\n                }),\n                (this.policy.exists ? Button.component({\n                    type: 'submit',\n                    className: 'Button Button--danger',\n                    children: app.translator.trans('flagrow-terms.admin.buttons.delete-policy'),\n                    loading: this.processing,\n                    onclick: this.deletePolicy.bind(this),\n                }) : ''),\n            ]),\n        ]);\n    }\n\n    updateAttribute(attribute, value) {\n        this.policy.pushAttributes({\n            [attribute]: value,\n        });\n\n        this.dirty = true;\n    }\n\n    readyToSave() {\n        return this.dirty;\n    }\n\n    savePolicy() {\n        this.processing = true;\n\n        const createNewRecord = !this.policy.exists;\n\n        this.policy.save(this.policy.data.attributes).then(() => {\n            if (createNewRecord) {\n                this.initNewField();\n                this.toggleFields = false;\n            }\n\n            this.processing = false;\n            this.dirty = false;\n\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n\n            throw err;\n        });\n    }\n\n    deletePolicy() {\n        if (!confirm(app.translator.trans('flagrow-terms.admin.messages.delete-policy-confirmation', {\n                name: this.policy.name(),\n            }).join(''))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.policy.delete().then(() => {\n            this.processing = false;\n\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/app';\nimport Component from 'flarum/Component';\nimport PolicyEdit from './PolicyEdit';\nimport sortByAttribute from '../../common/helpers/sortByAttribute';\n\nexport default class PolicyList extends Component {\n    init() {\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/flagrow/terms/policies',\n        }).then(result => {\n            app.store.pushPayload(result);\n\n            m.redraw();\n        });\n    }\n\n    config() {\n        this.$('.js-policies-container')\n            .sortable({\n                handle: '.js-policy-handle',\n            })\n            .on('sortupdate', () => {\n                const sorting = this.$('.js-policy-data')\n                    .map(function () {\n                        return $(this).data('id');\n                    })\n                    .get();\n\n                this.updateSort(sorting);\n            });\n    }\n\n    view() {\n        const policies = app.store.all('flagrow-terms-policies');\n\n        let fieldsList = [];\n\n        sortByAttribute(policies)\n            .forEach(policy => {\n                // Build array of fields to show.\n                fieldsList.push(m('.js-policy-data', {\n                    key: policy.id(),\n                    'data-id': policy.id(),\n                }, PolicyEdit.component({\n                    policy,\n                })));\n            });\n\n        return m('div', [\n            m('h2', app.translator.trans('flagrow-terms.admin.titles.policies')),\n            m('.Flagrow-Terms-Policies-Container', [\n                m('.js-policies-container', fieldsList),\n                PolicyEdit.component({\n                    key: 'new',\n                    policy: null,\n                }),\n            ]),\n        ]);\n    }\n\n    updateSort(sorting) {\n        app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/flagrow/terms/policies/order',\n            data: {\n                sort: sorting,\n            },\n        }).then(result => {\n            // Update sort attributes\n            app.store.pushPayload(result);\n\n            m.redraw();\n        });\n    }\n}\n","import app from 'flarum/app';\nimport SettingsModal from 'flarum/components/SettingsModal';\nimport Switch from 'flarum/components/Switch';\nimport PolicyList from './PolicyList';\n\nconst settingsPrefix = 'flagrow-terms.';\nconst translationPrefix = 'flagrow-terms.admin.settings.';\n\nexport default class TermsSettingsModal extends SettingsModal {\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    form() {\n        return [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'field.signup-legal-text')),\n                m('textarea.FormControl', {\n                    bidi: this.setting(settingsPrefix + 'signup-legal-text'),\n                }),\n            ]),\n            m('.Form-group', [\n                m('label', Switch.component({\n                    state: this.setting(settingsPrefix + 'hide-updated-at')() > 0,\n                    onchange: this.setting(settingsPrefix + 'hide-updated-at'),\n                    children: app.translator.trans(translationPrefix + 'field.hide-updated-at'),\n                })),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'field.date-format')),\n                m('input[type=text].FormControl', {\n                    bidi: this.setting(settingsPrefix + 'date-format'),\n                    placeholder: 'YYYY-MM-DD',\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'field.date-format-help', {\n                    a: m('a', {\n                        href: 'https://momentjs.com/docs/#/displaying/format/',\n                        target: '_blank',\n                    }),\n                })),\n            ]),\n            PolicyList.component(),\n        ];\n    }\n}\n","import 'jquery-sortable';\nimport app from 'flarum/app';\nimport Policy from '../common/models/Policy';\nimport TermsSettingsModal from './components/TermsSettingsModal';\nimport addPermissions from './addPermissions';\n\napp.initializers.add('flagrow-terms', app => {\n    app.store.models['flagrow-terms-policies'] = Policy;\n\n    app.extensionSettings['flagrow-terms'] = () => app.modal.show(new TermsSettingsModal());\n\n    addPermissions();\n});\n","export default function (items, attr = 'sort') {\n    return items.sort(\n        (a, b) => a[attr]() - b[attr]()\n    );\n}\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\nimport computed from 'flarum/utils/computed';\n\nexport default class Policy extends mixin(Model, {\n    sort: Model.attribute('sort'),\n    name: Model.attribute('name'),\n    url: Model.attribute('url'),\n    update_message: Model.attribute('update_message'),\n    terms_updated_at: Model.attribute('terms_updated_at'),\n    form_key: computed('id', id => 'flagrow_terms_policy_' + id),\n}) {\n    /**\n     * @inheritDoc\n     */\n    apiEndpoint() {\n        return '/flagrow/terms/policies' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/PermissionGrid'];","module.exports = flarum.core.compat['components/SettingsModal'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['utils/computed'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}